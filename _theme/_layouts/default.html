<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>{{ page.title }} - {{ site.title }}</title>
  <link rel="stylesheet" href="{{ "/Meshtastic-Experiments/assets/css/style.css" | relative_url }}">
  <style>
    body {
      display: flex;
      flex-direction: column;
      font-family: Arial, sans-serif;
      background-color: #333333; /* Charcoal background */
      color: #ffffff; /* White text */
      min-height: 100vh;
      margin: 0;
    }
    .main-container {
      display: flex;
      flex: 1;
      width: 100%;
    }
    .sidebar {
      width: 200px;
      padding: 10px;
      background: #000000; /* Black background */
      height: 100vh; /* Full height */
      position: fixed; /* Fix sidebar in place */
      color: #00FFFF; /* Electric blue text */
    }
    .sidebar h1, .sidebar p {
      color: #00FFFF; /* Electric blue text */
    }
    .content {
      margin-left: 220px; /* Ensure content is not hidden behind the fixed sidebar */
      flex: 1;
      padding: 20px;
      background-color: #1a1a1a; /* Darker charcoal background for content */
      overflow-x: auto;
    }
    nav ul {
      list-style-type: none;
      padding: 0;
    }
    nav ul li {
      margin: 10px 0;
    }
    nav ul li a {
      display: block;
      text-decoration: none;
      color: #000000; /* Black text */
      background-color: #FFD700; /* Bright yellow background */
      padding: 10px;
      border-radius: 5px;
      text-align: center;
    }
    nav ul li a:hover {
      background-color: #ffffff; /* White background on hover */
      color: #FFD700; /* Bright yellow text on hover */
    }
    nav ul li a.active {
      background-color: #ffffff; /* White background for active page */
      color: #FFD700; /* Bright yellow text for active page */
    }
    table {
      width: 100%; /* Full width for tables */
      border-collapse: collapse;
      margin: 20px 0;
    }
    th, td {
      border: 1px solid #00FFFF; /* Electric blue border */
      padding: 8px;
      text-align: left;
      color: #ffffff; /* White text */
    }
    th {
      background-color: #1a1a1a; /* Darker charcoal for table headers */
      position: sticky;
      top: 0; /* Stick to the top when scrolling */
      z-index: 1; /* Ensure it stays on top of other content */
    }
    tbody tr:nth-child(odd) {
      background-color: #333333; /* Charcoal for odd rows */
    }
    tbody tr:nth-child(even) {
      background-color: #1a1a1a; /* Darker charcoal for even rows */
    }
    details {
      margin-bottom: 20px;
    }
    details summary {
      font-weight: bold;
      cursor: pointer;
      color: #00FFFF; /* Electric blue for summary */
    }
    details[open] summary {
      color: #ffffff; /* White text when open */
    }
    footer {
      text-align: center;
      padding: 5px 10px;
      background: #000000; /* Black background for footer */
      color: #00FFFF; /* Electric blue text */
      width: 100%;
      flex-shrink: 0;
    }
    a {
      color: #FFD700; /* Bright yellow links */
    }
    a:hover {
      color: #ffffff; /* White text on hover */
    }
  </style>
</head>
<body>
  <div class="main-container">
    <div class="sidebar">
      <header>
        <h1><a href="{{ site.baseurl }}/" style="color: #00FFFF; text-decoration: none;">{{ site.title }}</a></h1>
        <p>{{ site.description }}</p>
      </header>
      <nav>
        <ul>
          {% for item in site.navbar %}
            <li><a href="{{ item.url | relative_url }}" class="{% if page.url == item.url %}active{% endif %}">{{ item.title }}</a></li>
          {% endfor %}
        </ul>
      </nav>
      <!-- Buy Me a Coffee Button -->
      <script type="text/javascript" src="https://cdnjs.buymeacoffee.com/1.0.0/button.prod.min.js" data-name="bmc-button" data-slug="HarukiToreda" data-color="#707070" data-emoji=""  data-font="Cookie" data-text="Buy me a coffee" data-outline-color="#ffffff" data-font-color="#ffffff" data-coffee-color="#FFDD00" ></script>
    </div>
    <div class="content">
      {{ content }}
    </div>
  </div>
  <footer>
    <p>&copy; {{ site.time | date: "%Y" }} {{ site.title }}</p>
  </footer>

  <script>
  document.querySelectorAll('.mcuFilter, .loraFilter, .gpsFilter, .screenFilter, .wifiFilter, .inputFilter, .priceFilter, .brandFilter, .caseFilter, .batteryFilter, .meshtasticFilter, .readyFilter').forEach(filter => {
    filter.addEventListener('change', filterTable);
  });

  function filterTable() {
    const mcuFilters = Array.from(document.querySelectorAll('.mcuFilter:checked')).map(cb => cb.value);
    const loraFilters = Array.from(document.querySelectorAll('.loraFilter:checked')).map(cb => cb.value);
    const gpsFilters = Array.from(document.querySelectorAll('.gpsFilter:checked')).map(cb => cb.value);
    const screenFilters = Array.from(document.querySelectorAll('.screenFilter:checked')).map(cb => cb.value);
    const wifiFilters = Array.from(document.querySelectorAll('.wifiFilter:checked')).map(cb => cb.value);
    const inputFilters = Array.from(document.querySelectorAll('.inputFilter:checked')).map(cb => cb.value);
    const priceFilters = Array.from(document.querySelectorAll('.priceFilter:checked')).map(cb => cb.value);
    const brandFilters = Array.from(document.querySelectorAll('.brandFilter:checked')).map(cb => cb.value);
    const caseFilters = Array.from(document.querySelectorAll('.caseFilter:checked')).map(cb => cb.value);
    const batteryFilters = Array.from(document.querySelectorAll('.batteryFilter:checked')).map(cb => cb.value);
    const meshtasticFilters = Array.from(document.querySelectorAll('.meshtasticFilter:checked')).map(cb => cb.value);
    const readyFilters = Array.from(document.querySelectorAll('.readyFilter:checked')).map(cb => cb.value);

    const columns = document.querySelectorAll('#comparisonTable thead th');
    const rows = document.querySelectorAll('#comparisonTable tbody tr');

    function getPriceRange(price) {
      if (price <= 20) return '0-20';
      if (price <= 40) return '21-40';
      if (price <= 60) return '41-60';
      return '61+';
    }

    function shouldDisplayColumn(column) {
      const mcu = column.getAttribute('data-mcu');
      const lora = column.getAttribute('data-lora');
      const gps = column.getAttribute('data-gps');
      const screen = column.getAttribute('data-screen');
      const wifi = column.getAttribute('data-wifi');
      const input = column.getAttribute('data-input').split(', ');
      const price = parseFloat(column.getAttribute('data-price'));
      const brand = column.getAttribute('data-brand');
      const caseIncluded = column.getAttribute('data-case');
      const batteryIncluded = column.getAttribute('data-battery');
      const meshtastic = column.getAttribute('data-meshtastic');
      const ready = column.getAttribute('data-ready');

      const mcuMatch = mcuFilters.length === 0 || mcuFilters.includes(mcu);
      const loraMatch = loraFilters.length === 0 || loraFilters.includes(lora);
      const gpsMatch = gpsFilters.length === 0 || gpsFilters.includes(gps);
      const screenMatch = screenFilters.length === 0 || screenFilters.includes(screen);
      const wifiMatch = wifiFilters.length === 0 || wifiFilters.includes(wifi);
      const inputMatch = inputFilters.length === 0 || inputFilters.some(inputType => input.includes(inputType));
      const priceMatch = priceFilters.length === 0 || priceFilters.includes(getPriceRange(price));
      const brandMatch = brandFilters.length === 0 || brandFilters.includes(brand);
      const caseMatch = caseFilters.length === 0 || caseFilters.includes(caseIncluded);
      const batteryMatch = batteryFilters.length === 0 || batteryFilters.includes(batteryIncluded);
      const meshtasticMatch = meshtasticFilters.length === 0 || meshtasticFilters.includes(meshtastic);
      const readyMatch = readyFilters.length === 0 || readyFilters.includes(ready);

      return mcuMatch && loraMatch && gpsMatch && screenMatch && wifiMatch && inputMatch && priceMatch && brandMatch && caseMatch && batteryMatch && meshtasticMatch && readyMatch;
    }

    columns.forEach(column => {
      if (column.cellIndex === 0) return;
      const display = shouldDisplayColumn(column) ? '' : 'none';
      column.style.display = display;
      rows.forEach(row => {
        row.children[column.cellIndex].style.display = display;
      });
    });
  }
  </script>
</body>
</html>
